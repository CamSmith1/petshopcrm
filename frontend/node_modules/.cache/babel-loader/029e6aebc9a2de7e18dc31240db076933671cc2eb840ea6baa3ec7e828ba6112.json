{"ast":null,"code":"import React from'react';import{Navigate,useLocation}from'react-router-dom';import{useAuth}from'../../context/AuthContext';/**\n * Protected Route component that redirects to login page if user is not authenticated.\n * Optionally redirects based on user role for role-specific routes.\n * \n * @param {Object} props - The component props\n * @param {React.ReactNode} props.children - The child components to render when authenticated\n * @param {String} props.requiredRole - Optional role requirement for accessing the route\n * @param {String} props.redirectPath - Custom redirect path (defaults to /login)\n * @returns {React.ReactElement} - The rendered component\n */import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProtectedRoute=_ref=>{let{children,requiredRole=null,redirectPath='/login'}=_ref;const{isAuthenticated,currentUser,authLoading}=useAuth();const location=useLocation();// In development mode, always allow access regardless of authentication\nconst isDevelopment=process.env.NODE_ENV==='development';// Show loading state if auth is still being checked (but not in development)\nif(authLoading&&!isDevelopment){return/*#__PURE__*/_jsxs(\"div\",{className:\"auth-loading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Checking authentication...\"})]});}// Check if user is authenticated (skip in development)\nif(!isAuthenticated&&!isDevelopment){// Redirect to login, but save the attempted location\nreturn/*#__PURE__*/_jsx(Navigate,{to:redirectPath,state:{from:location},replace:true});}// If a specific role is required, check user's role (skip in development)\nif(requiredRole&&(currentUser===null||currentUser===void 0?void 0:currentUser.role)!==requiredRole&&!isDevelopment){// Special case: if the route requires 'client' role and the user is 'admin',\n// allow access as admin can view client-specific routes\nif(!(requiredRole==='client'&&(currentUser===null||currentUser===void 0?void 0:currentUser.role)==='admin')){// Redirect based on role\nif((currentUser===null||currentUser===void 0?void 0:currentUser.role)==='admin'){return/*#__PURE__*/_jsx(Navigate,{to:\"/admin/dashboard\",replace:true});}else if((currentUser===null||currentUser===void 0?void 0:currentUser.role)==='business'){return/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\",replace:true});}else{return/*#__PURE__*/_jsx(Navigate,{to:\"/appointments\",replace:true});}}}// User is authenticated and has required role (if any)\nreturn children;};export default ProtectedRoute;","map":{"version":3,"names":["React","Navigate","useLocation","useAuth","jsx","_jsx","jsxs","_jsxs","ProtectedRoute","_ref","children","requiredRole","redirectPath","isAuthenticated","currentUser","authLoading","location","isDevelopment","process","env","NODE_ENV","className","to","state","from","replace","role"],"sources":["/home/toebot/dog-services-saas/frontend/src/components/auth/ProtectedRoute.js"],"sourcesContent":["import React from 'react';\nimport { Navigate, useLocation } from 'react-router-dom';\nimport { useAuth } from '../../context/AuthContext';\n\n/**\n * Protected Route component that redirects to login page if user is not authenticated.\n * Optionally redirects based on user role for role-specific routes.\n * \n * @param {Object} props - The component props\n * @param {React.ReactNode} props.children - The child components to render when authenticated\n * @param {String} props.requiredRole - Optional role requirement for accessing the route\n * @param {String} props.redirectPath - Custom redirect path (defaults to /login)\n * @returns {React.ReactElement} - The rendered component\n */\nconst ProtectedRoute = ({ \n  children, \n  requiredRole = null,\n  redirectPath = '/login'\n}) => {\n  const { isAuthenticated, currentUser, authLoading } = useAuth();\n  const location = useLocation();\n  \n  // In development mode, always allow access regardless of authentication\n  const isDevelopment = process.env.NODE_ENV === 'development';\n  \n  // Show loading state if auth is still being checked (but not in development)\n  if (authLoading && !isDevelopment) {\n    return (\n      <div className=\"auth-loading\">\n        <div className=\"spinner\"></div>\n        <p>Checking authentication...</p>\n      </div>\n    );\n  }\n  \n  // Check if user is authenticated (skip in development)\n  if (!isAuthenticated && !isDevelopment) {\n    // Redirect to login, but save the attempted location\n    return <Navigate to={redirectPath} state={{ from: location }} replace />;\n  }\n  \n  // If a specific role is required, check user's role (skip in development)\n  if (requiredRole && currentUser?.role !== requiredRole && !isDevelopment) {\n    // Special case: if the route requires 'client' role and the user is 'admin',\n    // allow access as admin can view client-specific routes\n    if (!(requiredRole === 'client' && currentUser?.role === 'admin')) {\n      // Redirect based on role\n      if (currentUser?.role === 'admin') {\n        return <Navigate to=\"/admin/dashboard\" replace />;\n      } else if (currentUser?.role === 'business') {\n        return <Navigate to=\"/dashboard\" replace />;\n      } else {\n        return <Navigate to=\"/appointments\" replace />;\n      }\n    }\n  }\n  \n  // User is authenticated and has required role (if any)\n  return children;\n};\n\nexport default ProtectedRoute;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,QAAQ,CAAEC,WAAW,KAAQ,kBAAkB,CACxD,OAASC,OAAO,KAAQ,2BAA2B,CAEnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GATA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAUA,KAAM,CAAAC,cAAc,CAAGC,IAAA,EAIjB,IAJkB,CACtBC,QAAQ,CACRC,YAAY,CAAG,IAAI,CACnBC,YAAY,CAAG,QACjB,CAAC,CAAAH,IAAA,CACC,KAAM,CAAEI,eAAe,CAAEC,WAAW,CAAEC,WAAY,CAAC,CAAGZ,OAAO,CAAC,CAAC,CAC/D,KAAM,CAAAa,QAAQ,CAAGd,WAAW,CAAC,CAAC,CAE9B;AACA,KAAM,CAAAe,aAAa,CAAGC,OAAO,CAACC,GAAG,CAACC,QAAQ,GAAK,aAAa,CAE5D;AACA,GAAIL,WAAW,EAAI,CAACE,aAAa,CAAE,CACjC,mBACEV,KAAA,QAAKc,SAAS,CAAC,cAAc,CAAAX,QAAA,eAC3BL,IAAA,QAAKgB,SAAS,CAAC,SAAS,CAAM,CAAC,cAC/BhB,IAAA,MAAAK,QAAA,CAAG,4BAA0B,CAAG,CAAC,EAC9B,CAAC,CAEV,CAEA;AACA,GAAI,CAACG,eAAe,EAAI,CAACI,aAAa,CAAE,CACtC;AACA,mBAAOZ,IAAA,CAACJ,QAAQ,EAACqB,EAAE,CAAEV,YAAa,CAACW,KAAK,CAAE,CAAEC,IAAI,CAAER,QAAS,CAAE,CAACS,OAAO,MAAE,CAAC,CAC1E,CAEA;AACA,GAAId,YAAY,EAAI,CAAAG,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEY,IAAI,IAAKf,YAAY,EAAI,CAACM,aAAa,CAAE,CACxE;AACA;AACA,GAAI,EAAEN,YAAY,GAAK,QAAQ,EAAI,CAAAG,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEY,IAAI,IAAK,OAAO,CAAC,CAAE,CACjE;AACA,GAAI,CAAAZ,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEY,IAAI,IAAK,OAAO,CAAE,CACjC,mBAAOrB,IAAA,CAACJ,QAAQ,EAACqB,EAAE,CAAC,kBAAkB,CAACG,OAAO,MAAE,CAAC,CACnD,CAAC,IAAM,IAAI,CAAAX,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEY,IAAI,IAAK,UAAU,CAAE,CAC3C,mBAAOrB,IAAA,CAACJ,QAAQ,EAACqB,EAAE,CAAC,YAAY,CAACG,OAAO,MAAE,CAAC,CAC7C,CAAC,IAAM,CACL,mBAAOpB,IAAA,CAACJ,QAAQ,EAACqB,EAAE,CAAC,eAAe,CAACG,OAAO,MAAE,CAAC,CAChD,CACF,CACF,CAEA;AACA,MAAO,CAAAf,QAAQ,CACjB,CAAC,CAED,cAAe,CAAAF,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}